import React, { useState, useEffect, useRef } from 'react';
import { 
  ShoppingCart, Home, Menu, X, User, Search, Heart, ChevronLeft, ChevronRight,
  Star, Package, Truck, Shield, CreditCard, MapPin, Mail, Phone, Clock, CheckCircle,
  AlertTriangle, Loader2, Plus, Minus, Trash2, Edit, Settings, LogOut, Play, Pause,
  Globe, DollarSign, ArrowRight, Zap, Target, Award, Users, TrendingUp, Gift
} from 'lucide-react';
import { Product, CartItem, ViewState, StoreConfig, HeroSlide, BundleOffer, CustomPage } from './types';
import { PRODUCTS as allProducts } from './products';
import { AdminDashboard } from './components/AdminDashboard';
import { t, getCurrencySymbol } from './src/utils/translations';
import { formatCurrency, convertCurrency } from './src/utils/currency';

// Helper function
const formatPrice = (amount: number, currency: string) => {
  return formatCurrency(amount, currency, 'en-US');
};

// Default Store Configuration
const DEFAULT_CONFIG: StoreConfig = {
  storeName: 'LURE MEOW',
  shopName: 'LURE MEOW',
  logoType: 'TEXT',
  marqueeText: 'üéâ FREE SHIPPING ON ORDERS OVER $100 üéâ',
  contactEmail: 'support@luremeow.com',
  heroSlides: [
    {
      id: 'slide1',
      image: 'https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=1200',
      title1: 'CYBER',
      title2: 'FASHION',
      subtitle: 'NEON COLLECTION 2024',
      desc: 'Experience the future of style',
      cta: 'SHOP NOW'
    }
  ],
  sectors: [],
  categories: ['All', 'Electronics', 'Fashion', 'Accessories', 'Beauty', 'Sports'],
  customPages: [],
  bundleOffers: [],
  shippingConfig: {
    type: 'THRESHOLD',
    fixedAmount: 10,
    freeShippingThreshold: 100
  },
  paypalConfig: {
    clientId: 'AWpU3pWBDzw9f0otzwofJphfLltTn7fsu9ZHjisxHM-MRXvVm3zQaMXbLh4GFTeZtv40l9D0mX4l4tmA',
    mode: 'sandbox',
    enabled: true
  }
};

const App: React.FC = () => {
  // State Management
  const [currentView, setCurrentView] = useState<ViewState>('HOME');
  const [cart, setCart] = useState<CartItem[]>([]);
  const [selectedProduct, setSelectedProduct] = useState<Product | null>(null);
  const [products, setProducts] = useState<Product[]>(allProducts);
  const [config, setConfig] = useState<StoreConfig>(DEFAULT_CONFIG);
  const [searchQuery, setSearchQuery] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('All');
  const [language, setLanguage] = useState<'en' | 'zh' | 'ja' | 'ko' | 'es' | 'fr' | 'de' | 'ru'>('en');
  const [currency, setCurrency] = useState<'USD' | 'EUR' | 'GBP' | 'JPY' | 'CNY'>('USD');
  const [showMobileMenu, setShowMobileMenu] = useState(false);
  const [showCart, setShowCart] = useState(false);
  const [isAdminMode, setIsAdminMode] = useState(false);
  const [currentSlide, setCurrentSlide] = useState(0);
  const [isProcessing, setIsProcessing] = useState(false);
  const [customPageSlug, setCustomPageSlug] = useState('');

  // Cart Functions
  const addToCart = (product: Product, bundleInfo?: { bundleId: string; bundlePrice: number }) => {
    setCart(prev => {
      if (bundleInfo) {
        // Bundle item
        return [...prev, { 
          ...product, 
          quantity: 1, 
          isBundleItem: true,
          bundleId: bundleInfo.bundleId,
          bundleDiscountPrice: bundleInfo.bundlePrice 
        }];
      } else {
        // Regular item
        const existing = prev.find(item => item.id === product.id && !item.isBundleItem);
        if (existing) {
          return prev.map(item =>
            item.id === product.id && !item.isBundleItem
              ? { ...item, quantity: item.quantity + 1 }
              : item
          );
        }
        return [...prev, { ...product, quantity: 1 }];
      }
    });
  };

  const removeFromCart = (productId: string, bundleId?: string) => {
    setCart(prev => prev.filter(item => {
      if (bundleId) {
        return !(item.id === productId && item.bundleId === bundleId);
      }
      return item.id !== productId;
    }));
  };

  const updateQuantity = (productId: string, change: number, bundleId?: string) => {
    setCart(prev =>
      prev.map(item => {
        if (bundleId) {
          return item.id === productId && item.bundleId === bundleId
            ? { ...item, quantity: Math.max(1, item.quantity + change) }
            : item;
        }
        return item.id === productId && !item.isBundleItem
          ? { ...item, quantity: Math.max(1, item.quantity + change) }
          : item;
      }).filter(item => item.quantity > 0)
    );
  };

  const clearCart = () => setCart([]);

  // Calculate totals
  const subtotal = cart.reduce((sum, item) => {
    const price = item.isBundleItem && item.bundleDiscountPrice 
      ? item.bundleDiscountPrice 
      : item.price;
    return sum + price * item.quantity;
  }, 0);

  const shipping = config.shippingConfig?.type === 'FREE' 
    ? 0 
    : config.shippingConfig?.type === 'THRESHOLD' && subtotal >= (config.shippingConfig.freeShippingThreshold || 100)
    ? 0
    : config.shippingConfig?.fixedAmount || 0;

  const total = subtotal + shipping;

  // Navigation
  const handleViewChange = (view: ViewState, slug?: string) => {
    setCurrentView(view);
    if (view === 'CUSTOM_PAGE' && slug) {
      setCustomPageSlug(slug);
    }
    setShowMobileMenu(false);
  };

  const handleProductClick = (product: Product) => {
    setSelectedProduct(product);
    setCurrentView('PRODUCT_DETAIL');
  };

  // Admin Mode Toggle (Ctrl+Shift+A)
  useEffect(() => {
    const handleKeyPress = (e: KeyboardEvent) => {
      if (e.ctrlKey && e.shiftKey && e.key === 'A') {
        setIsAdminMode(prev => !prev);
      }
    };
    window.addEventListener('keydown', handleKeyPress);
    return () => window.removeEventListener('keydown', handleKeyPress);
  }, []);

  // Hero Slider Auto-play
  useEffect(() => {
    if (currentView === 'HOME' && config.heroSlides.length > 1) {
      const timer = setInterval(() => {
        setCurrentSlide(prev => (prev + 1) % config.heroSlides.length);
      }, 5000);
      return () => clearInterval(timer);
    }
  }, [currentView, config.heroSlides.length]);

  // Render Admin Dashboard
  if (isAdminMode) {
    return (
      <AdminDashboard
        products={products}
        config={config}
        onUpdateProducts={setProducts}
        onUpdateConfig={setConfig}
        onExit={() => setIsAdminMode(false)}
      />
    );
  }

  // Filter products
  const filteredProducts = products.filter(p => {
    const matchesSearch = p.name.toLowerCase().includes(searchQuery.toLowerCase());
    const matchesCategory = selectedCategory === 'All' || p.category === selectedCategory;
    return matchesSearch && matchesCategory;
  });

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 text-white">
      {/* Header */}
      <Header 
        cart={cart}
        language={language}
        currency={currency}
        onLanguageChange={setLanguage}
        onCurrencyChange={setCurrency}
        onNavigate={handleViewChange}
        onToggleCart={() => setShowCart(!showCart)}
        onToggleMobileMenu={() => setShowMobileMenu(!showMobileMenu)}
        config={config}
      />

      {/* Marquee */}
      {config.marqueeText && (
        <div className="bg-neon-purple py-2 overflow-hidden">
          <div className="animate-marquee whitespace-nowrap">
            <span className="text-sm font-bold text-black mx-8">{config.marqueeText}</span>
            <span className="text-sm font-bold text-black mx-8">{config.marqueeText}</span>
            <span className="text-sm font-bold text-black mx-8">{config.marqueeText}</span>
          </div>
        </div>
      )}

      {/* Main Content */}
      <main className="min-h-screen">
        {currentView === 'HOME' && (
          <HomePage
            config={config}
            products={products}
            currentSlide={currentSlide}
            onSlideChange={setCurrentSlide}
            onProductClick={handleProductClick}
            onNavigate={handleViewChange}
            language={language}
            currency={currency}
          />
        )}

        {currentView === 'SHOP' && (
          <ShopPage
            products={filteredProducts}
            searchQuery={searchQuery}
            selectedCategory={selectedCategory}
            categories={config.categories}
            onSearchChange={setSearchQuery}
            onCategoryChange={setSelectedCategory}
            onProductClick={handleProductClick}
            language={language}
            currency={currency}
          />
        )}

        {currentView === 'PRODUCT_DETAIL' && selectedProduct && (
          <ProductDetailPage
            product={selectedProduct}
            bundleOffer={config.bundleOffers?.find(b => b.mainProductId === selectedProduct.id && b.isActive)}
            products={products}
            onAddToCart={addToCart}
            onBack={() => setCurrentView('SHOP')}
            language={language}
            currency={currency}
          />
        )}

        {currentView === 'CHECKOUT' && (
          <CheckoutPage
            cart={cart}
            subtotal={subtotal}
            shipping={shipping}
            total={total}
            config={config}
            onUpdateQuantity={updateQuantity}
            onRemoveItem={removeFromCart}
            onBack={() => setCurrentView('SHOP')}
            onClearCart={clearCart}
            language={language}
            currency={currency}
          />
        )}

        {currentView === 'CUSTOM_PAGE' && (
          <CustomPageView
            slug={customPageSlug}
            pages={config.customPages || []}
            onBack={() => setCurrentView('HOME')}
            language={language}
          />
        )}
      </main>

      {/* Cart Sidebar */}
      <CartSidebar
        cart={cart}
        show={showCart}
        onClose={() => setShowCart(false)}
        onCheckout={() => {
          setShowCart(false);
          setCurrentView('CHECKOUT');
        }}
        onUpdateQuantity={updateQuantity}
        onRemove={removeFromCart}
        subtotal={subtotal}
        language={language}
        currency={currency}
      />

      {/* Mobile Menu */}
      <MobileMenu
        show={showMobileMenu}
        onClose={() => setShowMobileMenu(false)}
        onNavigate={handleViewChange}
        config={config}
        language={language}
      />

      {/* Footer */}
      <Footer config={config} onNavigate={handleViewChange} language={language} />
    </div>
  );
};

// ===== COMPONENT: Header =====
const Header: React.FC<{
  cart: CartItem[];
  language: string;
  currency: string;
  onLanguageChange: (lang: any) => void;
  onCurrencyChange: (curr: any) => void;
  onNavigate: (view: ViewState) => void;
  onToggleCart: () => void;
  onToggleMobileMenu: () => void;
  config: StoreConfig;
}> = ({ cart, language, currency, onLanguageChange, onCurrencyChange, onNavigate, onToggleCart, onToggleMobileMenu, config }) => {
  const cartCount = cart.reduce((sum, item) => sum + item.quantity, 0);

  return (
    <header className="sticky top-0 z-40 bg-black/95 backdrop-blur-md border-b border-white/10">
      <div className="container mx-auto px-4 py-4">
        <div className="flex items-center justify-between">
          {/* Logo */}
          <button 
            onClick={() => onNavigate('HOME')}
            className="text-2xl font-display font-bold text-neon-cyan hover:text-neon-purple transition-colors"
          >
            {config.logoType === 'IMAGE' && config.logoImage ? (
              <img src={config.logoImage} alt={config.storeName} className="h-10 object-contain" />
            ) : (
              config.storeName
            )}
          </button>

          {/* Desktop Nav */}
          <nav className="hidden md:flex items-center gap-6">
            <NavButton label={t('Home', language)} onClick={() => onNavigate('HOME')} />
            <NavButton label={t('Shop', language)} onClick={() => onNavigate('SHOP')} />
            {config.customPages?.filter(p => p.isPublished && p.showInFooter).map(page => (
              <NavButton 
                key={page.id} 
                label={page.title} 
                onClick={() => onNavigate('CUSTOM_PAGE', page.slug)} 
              />
            ))}
          </nav>

          {/* Right Actions */}
          <div className="flex items-center gap-4">
            <LanguageSelector value={language} onChange={onLanguageChange} />
            <CurrencySelector value={currency} onChange={onCurrencyChange} />
            
            <button
              onClick={onToggleCart}
              className="relative p-2 hover:bg-white/10 rounded-lg transition-colors"
            >
              <ShoppingCart size={20} className="text-neon-purple" />
              {cartCount > 0 && (
                <span className="absolute -top-1 -right-1 bg-neon-pink text-black text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center">
                  {cartCount}
                </span>
              )}
            </button>

            <button
              onClick={onToggleMobileMenu}
              className="md:hidden p-2 hover:bg-white/10 rounded-lg transition-colors"
            >
              <Menu size={20} />
            </button>
          </div>
        </div>
      </div>
    </header>
  );
};

const NavButton: React.FC<{ label: string; onClick: () => void }> = ({ label, onClick }) => (
  <button
    onClick={onClick}
    className="text-sm font-medium text-white/80 hover:text-neon-cyan transition-colors"
  >
    {label}
  </button>
);

const LanguageSelector: React.FC<{ value: string; onChange: (val: any) => void }> = ({ value, onChange }) => {
  const languages = [
    { code: 'en', flag: 'üá¨üáß', name: 'English' },
    { code: 'zh', flag: 'üá®üá≥', name: '‰∏≠Êñá' },
    { code: 'ja', flag: 'üáØüáµ', name: 'Êó•Êú¨Ë™û' },
    { code: 'ko', flag: 'üá∞üá∑', name: 'ÌïúÍµ≠Ïñ¥' },
    { code: 'es', flag: 'üá™üá∏', name: 'Espa√±ol' },
    { code: 'fr', flag: 'üá´üá∑', name: 'Fran√ßais' },
    { code: 'de', flag: 'üá©üá™', name: 'Deutsch' },
    { code: 'ru', flag: 'üá∑üá∫', name: '–†—É—Å—Å–∫–∏–π' }
  ];

  return (
    <div className="relative group">
      <button className="flex items-center gap-2 px-3 py-2 bg-black/50 border border-white/20 rounded hover:border-neon-cyan transition-colors">
        <Globe size={16} className="text-neon-cyan" />
        <span className="text-sm">{languages.find(l => l.code === value)?.flag}</span>
      </button>
      <div className="absolute right-0 mt-2 w-48 bg-black border border-white/20 rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50">
        {languages.map(lang => (
          <button
            key={lang.code}
            onClick={() => onChange(lang.code)}
            className={`w-full px-4 py-2 text-left hover:bg-white/10 transition-colors flex items-center gap-3 ${
              value === lang.code ? 'text-neon-cyan' : 'text-white'
            }`}
          >
            <span className="text-xl">{lang.flag}</span>
            <span className="text-sm">{lang.name}</span>
          </button>
        ))}
      </div>
    </div>
  );
};

const CurrencySelector: React.FC<{ value: string; onChange: (val: any) => void }> = ({ value, onChange }) => {
  const currencies = [
    { code: 'USD', symbol: '$', name: 'US Dollar' },
    { code: 'EUR', symbol: '‚Ç¨', name: 'Euro' },
    { code: 'GBP', symbol: '¬£', name: 'British Pound' },
    { code: 'JPY', symbol: '¬•', name: 'Japanese Yen' },
    { code: 'CNY', symbol: '¬•', name: 'Chinese Yuan' }
  ];

  return (
    <div className="relative group">
      <button className="flex items-center gap-2 px-3 py-2 bg-black/50 border border-white/20 rounded hover:border-neon-purple transition-colors">
        <DollarSign size={16} className="text-neon-purple" />
        <span className="text-sm font-bold">{currencies.find(c => c.code === value)?.symbol}</span>
      </button>
      <div className="absolute right-0 mt-2 w-48 bg-black border border-white/20 rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50">
        {currencies.map(curr => (
          <button
            key={curr.code}
            onClick={() => onChange(curr.code)}
            className={`w-full px-4 py-2 text-left hover:bg-white/10 transition-colors flex items-center gap-3 ${
              value === curr.code ? 'text-neon-purple' : 'text-white'
            }`}
          >
            <span className="text-lg font-bold">{curr.symbol}</span>
            <span className="text-sm">{curr.name}</span>
          </button>
        ))}
      </div>
    </div>
  );
};

// ===== COMPONENT: HomePage =====
const HomePage: React.FC<{
  config: StoreConfig;
  products: Product[];
  currentSlide: number;
  onSlideChange: (index: number) => void;
  onProductClick: (product: Product) => void;
  onNavigate: (view: ViewState) => void;
  language: string;
  currency: string;
}> = ({ config, products, currentSlide, onSlideChange, onProductClick, onNavigate, language, currency }) => {
  const heroSlides = config.heroSlides || [];
  const featuredProducts = products.slice(0, 8);

  return (
    <div className="space-y-12">
      {/* Hero Slider */}
      {heroSlides.length > 0 && (
        <div className="relative h-[70vh] overflow-hidden">
          {heroSlides.map((slide, index) => (
            <div
              key={slide.id}
              className={`absolute inset-0 transition-opacity duration-1000 ${
                index === currentSlide ? 'opacity-100' : 'opacity-0'
              }`}
              style={{
                backgroundImage: `url(${slide.image})`,
                backgroundSize: 'cover',
                backgroundPosition: 'center'
              }}
            >
              <div className="absolute inset-0 bg-black/50 backdrop-blur-sm" />
              <div className="relative h-full container mx-auto px-4 flex items-center">
                <div className="max-w-2xl space-y-6">
                  <h1 className="text-6xl md:text-8xl font-display font-black">
                    <span className="text-neon-cyan">{slide.title1}</span>
                    <br />
                    <span className="text-neon-purple">{slide.title2}</span>
                  </h1>
                  <p className="text-2xl text-neon-pink font-bold">{slide.subtitle}</p>
                  <p className="text-lg text-white/80">{slide.desc}</p>
                  <button
                    onClick={() => onNavigate('SHOP')}
                    className="px-8 py-4 bg-neon-cyan text-black font-bold rounded-lg hover:bg-neon-purple hover:text-white transition-all transform hover:scale-105"
                  >
                    {slide.cta}
                  </button>
                </div>
              </div>
            </div>
          ))}

          {/* Slider Controls */}
          {heroSlides.length > 1 && (
            <>
              <button
                onClick={() => onSlideChange((currentSlide - 1 + heroSlides.length) % heroSlides.length)}
                className="absolute left-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 hover:bg-black/70 rounded-full transition-colors"
              >
                <ChevronLeft size={24} />
              </button>
              <button
                onClick={() => onSlideChange((currentSlide + 1) % heroSlides.length)}
                className="absolute right-4 top-1/2 -translate-y-1/2 p-3 bg-black/50 hover:bg-black/70 rounded-full transition-colors"
              >
                <ChevronRight size={24} />
              </button>
              <div className="absolute bottom-8 left-1/2 -translate-x-1/2 flex gap-2">
                {heroSlides.map((_, index) => (
                  <button
                    key={index}
                    onClick={() => onSlideChange(index)}
                    className={`w-3 h-3 rounded-full transition-all ${
                      index === currentSlide ? 'bg-neon-cyan w-8' : 'bg-white/30'
                    }`}
                  />
                ))}
              </div>
            </>
          )}
        </div>
      )}

      {/* Featured Products */}
      <div className="container mx-auto px-4">
        <div className="text-center mb-8">
          <h2 className="text-4xl font-display font-bold mb-2">
            <span className="text-neon-cyan">{t('Featured', language)}</span>{' '}
            <span className="text-neon-purple">{t('Products', language)}</span>
          </h2>
          <p className="text-white/60">{t('Check out our latest items', language)}</p>
        </div>

        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
          {featuredProducts.map(product => (
            <ProductCard
              key={product.id}
              product={product}
              onClick={() => onProductClick(product)}
              language={language}
              currency={currency}
            />
          ))}
        </div>

        <div className="text-center mt-12">
          <button
            onClick={() => onNavigate('SHOP')}
            className="px-8 py-4 bg-gradient-to-r from-neon-cyan to-neon-purple text-white font-bold rounded-lg hover:shadow-[0_0_20px_rgba(0,249,255,0.5)] transition-all"
          >
            {t('View All Products', language)} <ArrowRight className="inline ml-2" size={20} />
          </button>
        </div>
      </div>

      {/* Features */}
      <div className="bg-black/30 py-16">
        <div className="container mx-auto px-4">
          <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
            <FeatureCard icon={<Truck size={32} />} title={t('Free Shipping', language)} desc={t('On orders over $100', language)} />
            <FeatureCard icon={<Shield size={32} />} title={t('Secure Payment', language)} desc={t('100% secure transactions', language)} />
            <FeatureCard icon={<Package size={32} />} title={t('Easy Returns', language)} desc={t('30-day return policy', language)} />
            <FeatureCard icon={<Award size={32} />} title={t('Premium Quality', language)} desc={t('Top-rated products', language)} />
          </div>
        </div>
      </div>
    </div>
  );
};

const FeatureCard: React.FC<{ icon: React.ReactNode; title: string; desc: string }> = ({ icon, title, desc }) => (
  <div className="text-center space-y-4">
    <div className="inline-flex p-4 bg-neon-cyan/10 rounded-full text-neon-cyan">{icon}</div>
    <h3 className="font-bold text-lg">{title}</h3>
    <p className="text-sm text-white/60">{desc}</p>
  </div>
);

// ===== COMPONENT: ShopPage =====
const ShopPage: React.FC<{
  products: Product[];
  searchQuery: string;
  selectedCategory: string;
  categories: string[];
  onSearchChange: (query: string) => void;
  onCategoryChange: (category: string) => void;
  onProductClick: (product: Product) => void;
  language: string;
  currency: string;
}> = ({ products, searchQuery, selectedCategory, categories, onSearchChange, onCategoryChange, onProductClick, language, currency }) => {
  return (
    <div className="container mx-auto px-4 py-8">
      <h1 className="text-4xl font-display font-bold mb-8">
        <span className="text-neon-cyan">{t('Shop', language)}</span>{' '}
        <span className="text-neon-purple">{t('All Products', language)}</span>
      </h1>

      {/* Search & Filter */}
      <div className="mb-8 space-y-4">
        <div className="relative">
          <Search className="absolute left-4 top-1/2 -translate-y-1/2 text-white/40" size={20} />
          <input
            type="text"
            placeholder={t('Search products...', language)}
            value={searchQuery}
            onChange={(e) => onSearchChange(e.target.value)}
            className="w-full pl-12 pr-4 py-3 bg-black/50 border border-white/20 rounded-lg text-white placeholder-white/40 focus:border-neon-cyan outline-none"
          />
        </div>

        <div className="flex gap-2 overflow-x-auto pb-2">
          {categories.map(category => (
            <button
              key={category}
              onClick={() => onCategoryChange(category)}
              className={`px-4 py-2 rounded-lg font-medium whitespace-nowrap transition-all ${
                selectedCategory === category
                  ? 'bg-neon-cyan text-black'
                  : 'bg-black/50 text-white/60 hover:bg-white/10'
              }`}
            >
              {t(category, language)}
            </button>
          ))}
        </div>
      </div>

      {/* Products Grid */}
      {products.length === 0 ? (
        <div className="text-center py-20">
          <p className="text-2xl text-white/40">{t('No products found', language)}</p>
        </div>
      ) : (
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
          {products.map(product => (
            <ProductCard
              key={product.id}
              product={product}
              onClick={() => onProductClick(product)}
              language={language}
              currency={currency}
            />
          ))}
        </div>
      )}
    </div>
  );
};

// ===== COMPONENT: ProductCard =====
const ProductCard: React.FC<{
  product: Product;
  onClick: () => void;
  language: string;
  currency: string;
}> = ({ product, onClick, language, currency }) => {
  const stockColor = product.stockStatus === 'IN_STOCK' ? 'text-green-400' : product.stockStatus === 'LOW_STOCK' ? 'text-yellow-400' : 'text-red-400';
  const stockText = product.stockStatus === 'IN_STOCK' ? t('In Stock', language) : product.stockStatus === 'LOW_STOCK' ? t('Low Stock', language) : t('Out of Stock', language);

  return (
    <div
      onClick={onClick}
      className="group bg-black/50 border border-white/10 rounded-lg overflow-hidden hover:border-neon-cyan transition-all cursor-pointer transform hover:scale-105"
    >
      <div className="relative aspect-square overflow-hidden">
        <img
          src={product.images[0]}
          alt={product.name}
          className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"
        />
        {product.stockStatus === 'OUT_OF_STOCK' && (
          <div className="absolute inset-0 bg-black/70 flex items-center justify-center">
            <p className="text-2xl font-bold text-red-400">{t('Sold Out', language)}</p>
          </div>
        )}
      </div>
      <div className="p-4 space-y-2">
        <p className="text-xs text-white/40">{product.category}</p>
        <h3 className="font-bold text-lg line-clamp-2 group-hover:text-neon-cyan transition-colors">{product.name}</h3>
        <div className="flex items-center justify-between">
          <p className="text-2xl font-bold text-neon-purple">{formatPrice(product.price, currency)}</p>
          <p className={`text-xs font-medium ${stockColor}`}>{stockText}</p>
        </div>
      </div>
    </div>
  );
};

// ===== COMPONENT: ProductDetailPage =====
const ProductDetailPage: React.FC<{
  product: Product;
  bundleOffer?: BundleOffer;
  products: Product[];
  onAddToCart: (product: Product, bundleInfo?: { bundleId: string; bundlePrice: number }) => void;
  onBack: () => void;
  language: string;
  currency: string;
}> = ({ product, bundleOffer, products, onAddToCart, onBack, language, currency }) => {
  const [selectedImage, setSelectedImage] = useState(0);
  const [quantity, setQuantity] = useState(1);
  const [showBundleModal, setShowBundleModal] = useState(false);

  const bundleProduct = bundleOffer ? products.find(p => p.id === bundleOffer.bundleProductId) : null;

  return (
    <div className="container mx-auto px-4 py-8">
      <button
        onClick={onBack}
        className="flex items-center gap-2 text-white/60 hover:text-neon-cyan transition-colors mb-6"
      >
        <ChevronLeft size={20} />
        {t('Back to Shop', language)}
      </button>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-12">
        {/* Images */}
        <div className="space-y-4">
          <div className="aspect-square bg-black/50 rounded-lg overflow-hidden border border-white/10">
            <img
              src={product.images[selectedImage]}
              alt={product.name}
              className="w-full h-full object-cover"
            />
          </div>
          <div className="grid grid-cols-4 gap-4">
            {product.images.map((img, index) => (
              <button
                key={index}
                onClick={() => setSelectedImage(index)}
                className={`aspect-square rounded-lg overflow-hidden border-2 transition-all ${
                  selectedImage === index ? 'border-neon-cyan' : 'border-white/10 hover:border-white/30'
                }`}
              >
                <img src={img} alt={`${product.name} ${index + 1}`} className="w-full h-full object-cover" />
              </button>
            ))}
          </div>
        </div>

        {/* Details */}
        <div className="space-y-6">
          <div>
            <p className="text-sm text-white/40 mb-2">{product.category}</p>
            <h1 className="text-4xl font-display font-bold mb-4">{product.name}</h1>
            <div className="flex items-center gap-4">
              <p className="text-4xl font-bold text-neon-purple">{formatPrice(product.price, currency)}</p>
              <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                product.stockStatus === 'IN_STOCK' ? 'bg-green-400/20 text-green-400' :
                product.stockStatus === 'LOW_STOCK' ? 'bg-yellow-400/20 text-yellow-400' :
                'bg-red-400/20 text-red-400'
              }`}>
                {product.stockStatus === 'IN_STOCK' ? t('In Stock', language) :
                 product.stockStatus === 'LOW_STOCK' ? t('Low Stock', language) :
                 t('Out of Stock', language)}
              </span>
            </div>
          </div>

          <div className="prose prose-invert">
            <p className="text-white/80">{product.description}</p>
          </div>

          {/* Quantity & Add to Cart */}
          <div className="space-y-4">
            <div className="flex items-center gap-4">
              <label className="text-sm font-medium">{t('Quantity', language)}:</label>
              <div className="flex items-center gap-2">
                <button
                  onClick={() => setQuantity(Math.max(1, quantity - 1))}
                  className="p-2 bg-black/50 border border-white/20 rounded hover:border-neon-cyan transition-colors"
                >
                  <Minus size={16} />
                </button>
                <span className="w-12 text-center font-bold">{quantity}</span>
                <button
                  onClick={() => setQuantity(quantity + 1)}
                  className="p-2 bg-black/50 border border-white/20 rounded hover:border-neon-cyan transition-colors"
                >
                  <Plus size={16} />
                </button>
              </div>
            </div>

            <button
              onClick={() => {
                for (let i = 0; i < quantity; i++) {
                  onAddToCart(product);
                }
                alert(t('Added to cart', language));
              }}
              disabled={product.stockStatus === 'OUT_OF_STOCK'}
              className="w-full py-4 bg-neon-cyan text-black font-bold rounded-lg hover:bg-neon-purple hover:text-white transition-all disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {product.stockStatus === 'OUT_OF_STOCK' ? t('Out of Stock', language) : t('Add to Cart', language)}
            </button>
          </div>

          {/* Bundle Offer */}
          {bundleOffer && bundleProduct && (
            <div className="border border-neon-purple rounded-lg p-6 bg-neon-purple/10">
              <h3 className="text-xl font-bold mb-4 text-neon-purple">{bundleOffer.bundleTitle}</h3>
              <div className="flex items-center gap-4 mb-4">
                <img src={bundleProduct.images[0]} alt={bundleProduct.name} className="w-20 h-20 object-cover rounded" />
                <div className="flex-1">
                  <p className="font-medium">{bundleProduct.name}</p>
                  <p className="text-sm text-white/60 line-through">{formatPrice(bundleOffer.originalTotalPrice, currency)}</p>
                  <p className="text-2xl font-bold text-neon-cyan">{formatPrice(bundleOffer.bundlePrice, currency)}</p>
                  <p className="text-sm text-green-400">Save {bundleOffer.discountPercent.toFixed(0)}%</p>
                </div>
              </div>
              <button
                onClick={() => {
                  onAddToCart(product, { bundleId: bundleOffer.id, bundlePrice: product.price });
                  onAddToCart(bundleProduct, { bundleId: bundleOffer.id, bundlePrice: bundleProduct.price });
                  alert(t('Bundle added to cart', language));
                }}
                className="w-full py-3 bg-neon-purple text-white font-bold rounded-lg hover:bg-neon-cyan hover:text-black transition-all"
              >
                {t('Add Bundle to Cart', language)}
              </button>
            </div>
          )}

          {/* Specs */}
          <div className="border border-white/10 rounded-lg p-6 space-y-3">
            <h3 className="font-bold text-lg mb-4">{t('Specifications', language)}</h3>
            {Object.entries(product.specs).map(([key, value]) => (
              <div key={key} className="flex justify-between">
                <span className="text-white/60 capitalize">{key}:</span>
                <span className="font-medium">{value}</span>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};

// ===== COMPONENT: CheckoutPage =====
const CheckoutPage: React.FC<{
  cart: CartItem[];
  subtotal: number;
  shipping: number;
  total: number;
  config: StoreConfig;
  onUpdateQuantity: (id: string, change: number, bundleId?: string) => void;
  onRemoveItem: (id: string, bundleId?: string) => void;
  onBack: () => void;
  onClearCart: () => void;
  language: string;
  currency: string;
}> = ({ cart, subtotal, shipping, total, config, onUpdateQuantity, onRemoveItem, onBack, onClearCart, language, currency }) => {
  const [shippingInfo, setShippingInfo] = useState({
    name: '',
    email: '',
    phone: '',
    address: '',
    city: '',
    zipCode: '',
    country: ''
  });
  const [paymentMethod, setPaymentMethod] = useState<'paypal' | 'card' | 'wallet'>('paypal');

  const handleCheckout = async () => {
    if (!shippingInfo.name || !shippingInfo.email || !shippingInfo.address) {
      alert(t('Please fill in all required fields', language));
      return;
    }
    
    alert(t('Order placed successfully!', language));
    onClearCart();
    onBack();
  };

  if (cart.length === 0) {
    return (
      <div className="container mx-auto px-4 py-20 text-center">
        <ShoppingCart size={64} className="mx-auto mb-4 text-white/20" />
        <h2 className="text-2xl font-bold mb-4">{t('Your cart is empty', language)}</h2>
        <button
          onClick={onBack}
          className="px-8 py-3 bg-neon-cyan text-black font-bold rounded-lg hover:bg-neon-purple hover:text-white transition-all"
        >
          {t('Continue Shopping', language)}
        </button>
      </div>
    );
  }

  return (
    <div className="container mx-auto px-4 py-8">
      <button
        onClick={onBack}
        className="flex items-center gap-2 text-white/60 hover:text-neon-cyan transition-colors mb-6"
      >
        <ChevronLeft size={20} />
        {t('Back', language)}
      </button>

      <h1 className="text-4xl font-display font-bold mb-8">
        <span className="text-neon-cyan">{t('Checkout', language)}</span>
      </h1>

      <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
        {/* Left: Forms */}
        <div className="lg:col-span-2 space-y-8">
          {/* Shipping Information */}
          <div className="bg-black/50 border border-white/10 rounded-lg p-6">
            <h2 className="text-2xl font-bold mb-6 flex items-center gap-2">
              <MapPin className="text-neon-cyan" size={24} />
              {t('Shipping Information', language)}
            </h2>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <input
                type="text"
                placeholder={t('Full Name', language) + ' *'}
                value={shippingInfo.name}
                onChange={(e) => setShippingInfo({ ...shippingInfo, name: e.target.value })}
                className="col-span-2 px-4 py-3 bg-black border border-white/20 rounded-lg text-white placeholder-white/40 focus:border-neon-cyan outline-none"
              />
              <input
                type="email"
                placeholder={t('Email', language) + ' *'}
                value={shippingInfo.email}
                onChange={(e) => setShippingInfo({ ...shippingInfo, email: e.target.value })}
                className="px-4 py-3 bg-black border border-white/20 rounded-lg text-white placeholder-white/40 focus:border-neon-cyan outline-none"
              />
              <input
                type="tel"
                placeholder={t('Phone', language)}
                value={shippingInfo.phone}
                onChange={(e) => setShippingInfo({ ...shippingInfo, phone: e.target.value })}
                className="px-4 py-3 bg-black border border-white/20 rounded-lg text-white placeholder-white/40 focus:border-neon-cyan outline-none"
              />
              <input
                type="text"
                placeholder={t('Address', language) + ' *'}
                value={shippingInfo.address}
                onChange={(e) => setShippingInfo({ ...shippingInfo, address: e.target.value })}
                className="col-span-2 px-4 py-3 bg-black border border-white/20 rounded-lg text-white placeholder-white/40 focus:border-neon-cyan outline-none"
              />
              <input
                type="text"
                placeholder={t('City', language)}
                value={shippingInfo.city}
                onChange={(e) => setShippingInfo({ ...shippingInfo, city: e.target.value })}
                className="px-4 py-3 bg-black border border-white/20 rounded-lg text-white placeholder-white/40 focus:border-neon-cyan outline-none"
              />
              <input
                type="text"
                placeholder={t('ZIP Code', language)}
                value={shippingInfo.zipCode}
                onChange={(e) => setShippingInfo({ ...shippingInfo, zipCode: e.target.value })}
                className="px-4 py-3 bg-black border border-white/20 rounded-lg text-white placeholder-white/40 focus:border-neon-cyan outline-none"
              />
              <input
                type="text"
                placeholder={t('Country', language)}
                value={shippingInfo.country}
                onChange={(e) => setShippingInfo({ ...shippingInfo, country: e.target.value })}
                className="col-span-2 px-4 py-3 bg-black border border-white/20 rounded-lg text-white placeholder-white/40 focus:border-neon-cyan outline-none"
              />
            </div>
          </div>

          {/* Payment Method */}
          <div className="bg-black/50 border border-white/10 rounded-lg p-6">
            <h2 className="text-2xl font-bold mb-6 flex items-center gap-2">
              <CreditCard className="text-neon-purple" size={24} />
              {t('Payment Method', language)}
            </h2>
            <div className="space-y-3">
              <PaymentOption
                selected={paymentMethod === 'paypal'}
                onClick={() => setPaymentMethod('paypal')}
                icon={<CreditCard size={20} />}
                title="PayPal"
                desc={t('Pay with PayPal', language)}
              />
              <PaymentOption
                selected={paymentMethod === 'card'}
                onClick={() => setPaymentMethod('card')}
                icon={<CreditCard size={20} />}
                title={t('Credit/Debit Card', language)}
                desc={t('Visa, Mastercard, Amex', language)}
              />
              <PaymentOption
                selected={paymentMethod === 'wallet'}
                onClick={() => setPaymentMethod('wallet')}
                icon={<Shield size={20} />}
                title={t('Digital Wallet', language)}
                desc={t('Apple Pay, Google Pay', language)}
              />
            </div>
          </div>
        </div>

        {/* Right: Order Summary */}
        <div className="space-y-6">
          <div className="bg-black/50 border border-white/10 rounded-lg p-6 sticky top-24">
            <h2 className="text-2xl font-bold mb-6">{t('Order Summary', language)}</h2>
            
            <div className="space-y-4 mb-6 max-h-64 overflow-y-auto">
              {cart.map((item, index) => (
                <div key={`${item.id}-${item.bundleId || index}`} className="flex gap-4">
                  <img src={item.images[0]} alt={item.name} className="w-16 h-16 object-cover rounded" />
                  <div className="flex-1 min-w-0">
                    <p className="font-medium text-sm truncate">{item.name}</p>
                    {item.isBundleItem && <p className="text-xs text-neon-purple">{t('Bundle Item', language)}</p>}
                    <div className="flex items-center gap-2 mt-1">
                      <button
                        onClick={() => onUpdateQuantity(item.id, -1, item.bundleId)}
                        className="p-1 hover:text-neon-cyan"
                      >
                        <Minus size={12} />
                      </button>
                      <span className="text-sm">{item.quantity}</span>
                      <button
                        onClick={() => onUpdateQuantity(item.id, 1, item.bundleId)}
                        className="p-1 hover:text-neon-cyan"
                      >
                        <Plus size={12} />
                      </button>
                      <button
                        onClick={() => onRemoveItem(item.id, item.bundleId)}
                        className="ml-auto text-red-400 hover:text-red-300"
                      >
                        <Trash2 size={14} />
                      </button>
                    </div>
                  </div>
                  <p className="font-bold text-sm">
                    {formatPrice((item.isBundleItem && item.bundleDiscountPrice ? item.bundleDiscountPrice : item.price) * item.quantity, currency)}
                  </p>
                </div>
              ))}
            </div>

            <div className="space-y-3 border-t border-white/10 pt-4">
              <div className="flex justify-between text-sm">
                <span className="text-white/60">{t('Subtotal', language)}</span>
                <span className="font-medium">{formatPrice(subtotal, currency)}</span>
              </div>
              <div className="flex justify-between text-sm">
                <span className="text-white/60">{t('Shipping', language)}</span>
                <span className="font-medium">
                  {shipping === 0 ? <span className="text-green-400">{t('FREE', language)}</span> : formatPrice(shipping, currency)}
                </span>
              </div>
              <div className="flex justify-between text-lg font-bold border-t border-white/10 pt-3">
                <span>{t('Total', language)}</span>
                <span className="text-neon-cyan">{formatPrice(total, currency)}</span>
              </div>
            </div>

            <button
              onClick={handleCheckout}
              className="w-full mt-6 py-4 bg-neon-cyan text-black font-bold rounded-lg hover:bg-neon-purple hover:text-white transition-all"
            >
              {t('Place Order', language)} {formatPrice(total, currency)}
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};

const PaymentOption: React.FC<{
  selected: boolean;
  onClick: () => void;
  icon: React.ReactNode;
  title: string;
  desc: string;
}> = ({ selected, onClick, icon, title, desc }) => (
  <button
    onClick={onClick}
    className={`w-full p-4 border-2 rounded-lg text-left transition-all ${
      selected ? 'border-neon-cyan bg-neon-cyan/10' : 'border-white/10 hover:border-white/30'
    }`}
  >
    <div className="flex items-center gap-3">
      <div className={`${selected ? 'text-neon-cyan' : 'text-white/60'}`}>{icon}</div>
      <div className="flex-1">
        <p className="font-bold">{title}</p>
        <p className="text-sm text-white/60">{desc}</p>
      </div>
      {selected && <CheckCircle className="text-neon-cyan" size={20} />}
    </div>
  </button>
);

// ===== COMPONENT: CartSidebar =====
const CartSidebar: React.FC<{
  cart: CartItem[];
  show: boolean;
  onClose: () => void;
  onCheckout: () => void;
  onUpdateQuantity: (id: string, change: number, bundleId?: string) => void;
  onRemove: (id: string, bundleId?: string) => void;
  subtotal: number;
  language: string;
  currency: string;
}> = ({ cart, show, onClose, onCheckout, onUpdateQuantity, onRemove, subtotal, language, currency }) => {
  return (
    <>
      {/* Overlay */}
      <div
        className={`fixed inset-0 bg-black/50 backdrop-blur-sm z-40 transition-opacity ${
          show ? 'opacity-100' : 'opacity-0 pointer-events-none'
        }`}
        onClick={onClose}
      />

      {/* Sidebar */}
      <div
        className={`fixed top-0 right-0 h-full w-full max-w-md bg-black border-l border-white/10 z-50 transform transition-transform ${
          show ? 'translate-x-0' : 'translate-x-full'
        }`}
      >
        <div className="flex flex-col h-full">
          {/* Header */}
          <div className="p-6 border-b border-white/10 flex items-center justify-between">
            <h2 className="text-2xl font-bold">{t('Cart', language)} ({cart.reduce((sum, item) => sum + item.quantity, 0)})</h2>
            <button onClick={onClose} className="p-2 hover:bg-white/10 rounded-lg transition-colors">
              <X size={24} />
            </button>
          </div>

          {/* Items */}
          <div className="flex-1 overflow-y-auto p-6 space-y-4">
            {cart.length === 0 ? (
              <div className="text-center py-20">
                <ShoppingCart size={64} className="mx-auto mb-4 text-white/20" />
                <p className="text-white/60">{t('Your cart is empty', language)}</p>
              </div>
            ) : (
              cart.map((item, index) => (
                <div key={`${item.id}-${item.bundleId || index}`} className="flex gap-4 bg-white/5 p-4 rounded-lg">
                  <img src={item.images[0]} alt={item.name} className="w-20 h-20 object-cover rounded" />
                  <div className="flex-1 min-w-0">
                    <h3 className="font-bold text-sm truncate">{item.name}</h3>
                    {item.isBundleItem && (
                      <p className="text-xs text-neon-purple mb-1">{t('Bundle Item', language)}</p>
                    )}
                    <p className="text-lg font-bold text-neon-purple">
                      {formatPrice(item.isBundleItem && item.bundleDiscountPrice ? item.bundleDiscountPrice : item.price, currency)}
                    </p>
                    <div className="flex items-center gap-2 mt-2">
                      <button
                        onClick={() => onUpdateQuantity(item.id, -1, item.bundleId)}
                        className="p-1 bg-white/10 rounded hover:bg-white/20"
                      >
                        <Minus size={14} />
                      </button>
                      <span className="w-8 text-center font-bold">{item.quantity}</span>
                      <button
                        onClick={() => onUpdateQuantity(item.id, 1, item.bundleId)}
                        className="p-1 bg-white/10 rounded hover:bg-white/20"
                      >
                        <Plus size={14} />
                      </button>
                    </div>
                  </div>
                  <button
                    onClick={() => onRemove(item.id, item.bundleId)}
                    className="self-start text-red-400 hover:text-red-300"
                  >
                    <Trash2 size={18} />
                  </button>
                </div>
              ))
            )}
          </div>

          {/* Footer */}
          {cart.length > 0 && (
            <div className="p-6 border-t border-white/10 space-y-4">
              <div className="flex justify-between text-xl font-bold">
                <span>{t('Subtotal', language)}</span>
                <span className="text-neon-cyan">{formatPrice(subtotal, currency)}</span>
              </div>
              <button
                onClick={onCheckout}
                className="w-full py-4 bg-neon-cyan text-black font-bold rounded-lg hover:bg-neon-purple hover:text-white transition-all"
              >
                {t('Checkout', language)}
              </button>
            </div>
          )}
        </div>
      </div>
    </>
  );
};

// ===== COMPONENT: MobileMenu =====
const MobileMenu: React.FC<{
  show: boolean;
  onClose: () => void;
  onNavigate: (view: ViewState, slug?: string) => void;
  config: StoreConfig;
  language: string;
}> = ({ show, onClose, onNavigate, config, language }) => {
  const handleNavigate = (view: ViewState, slug?: string) => {
    onNavigate(view, slug);
    onClose();
  };

  return (
    <>
      <div
        className={`fixed inset-0 bg-black/50 backdrop-blur-sm z-40 transition-opacity ${
          show ? 'opacity-100' : 'opacity-0 pointer-events-none'
        }`}
        onClick={onClose}
      />

      <div
        className={`fixed top-0 left-0 h-full w-full max-w-sm bg-black border-r border-white/10 z-50 transform transition-transform ${
          show ? 'translate-x-0' : '-translate-x-full'
        }`}
      >
        <div className="p-6 space-y-6">
          <div className="flex items-center justify-between">
            <h2 className="text-2xl font-bold text-neon-cyan">{t('Menu', language)}</h2>
            <button onClick={onClose} className="p-2 hover:bg-white/10 rounded-lg">
              <X size={24} />
            </button>
          </div>

          <nav className="space-y-2">
            <MobileNavButton icon={<Home size={20} />} label={t('Home', language)} onClick={() => handleNavigate('HOME')} />
            <MobileNavButton icon={<ShoppingCart size={20} />} label={t('Shop', language)} onClick={() => handleNavigate('SHOP')} />
            {config.customPages?.filter(p => p.isPublished && p.showInFooter).map(page => (
              <MobileNavButton
                key={page.id}
                icon={<ArrowRight size={20} />}
                label={page.title}
                onClick={() => handleNavigate('CUSTOM_PAGE', page.slug)}
              />
            ))}
          </nav>
        </div>
      </div>
    </>
  );
};

const MobileNavButton: React.FC<{ icon: React.ReactNode; label: string; onClick: () => void }> = ({ icon, label, onClick }) => (
  <button
    onClick={onClick}
    className="w-full flex items-center gap-3 p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors"
  >
    <span className="text-neon-cyan">{icon}</span>
    <span className="font-medium">{label}</span>
  </button>
);

// ===== COMPONENT: CustomPageView =====
const CustomPageView: React.FC<{
  slug: string;
  pages: CustomPage[];
  onBack: () => void;
  language: string;
}> = ({ slug, pages, onBack, language }) => {
  const page = pages.find(p => p.slug === slug && p.isPublished);

  if (!page) {
    return (
      <div className="container mx-auto px-4 py-20 text-center">
        <h1 className="text-4xl font-bold mb-4">{t('Page Not Found', language)}</h1>
        <button
          onClick={onBack}
          className="px-8 py-3 bg-neon-cyan text-black font-bold rounded-lg hover:bg-neon-purple hover:text-white transition-all"
        >
          {t('Go Back', language)}
        </button>
      </div>
    );
  }

  return (
    <div className="container mx-auto px-4 py-8">
      <button
        onClick={onBack}
        className="flex items-center gap-2 text-white/60 hover:text-neon-cyan transition-colors mb-6"
      >
        <ChevronLeft size={20} />
        {t('Back', language)}
      </button>

      <div className="max-w-4xl mx-auto">
        <h1 className="text-4xl font-display font-bold mb-8 text-neon-cyan">{page.title}</h1>
        <div className="prose prose-invert max-w-none">
          <div dangerouslySetInnerHTML={{ __html: page.content }} />
        </div>
      </div>
    </div>
  );
};

// ===== COMPONENT: Footer =====
const Footer: React.FC<{
  config: StoreConfig;
  onNavigate: (view: ViewState, slug?: string) => void;
  language: string;
}> = ({ config, onNavigate, language }) => {
  return (
    <footer className="bg-black border-t border-white/10 py-12 mt-20">
      <div className="container mx-auto px-4">
        <div className="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
          {/* Brand */}
          <div>
            <h3 className="text-2xl font-display font-bold text-neon-cyan mb-4">{config.storeName}</h3>
            <p className="text-sm text-white/60">{t('Your trusted online shop for quality products', language)}</p>
          </div>

          {/* Quick Links */}
          <div>
            <h4 className="font-bold mb-4">{t('Quick Links', language)}</h4>
            <ul className="space-y-2 text-sm">
              <li>
                <button onClick={() => onNavigate('HOME')} className="text-white/60 hover:text-neon-cyan transition-colors">
                  {t('Home', language)}
                </button>
              </li>
              <li>
                <button onClick={() => onNavigate('SHOP')} className="text-white/60 hover:text-neon-cyan transition-colors">
                  {t('Shop', language)}
                </button>
              </li>
            </ul>
          </div>

          {/* Custom Pages */}
          <div>
            <h4 className="font-bold mb-4">{t('Information', language)}</h4>
            <ul className="space-y-2 text-sm">
              {config.customPages?.filter(p => p.isPublished && p.showInFooter).map(page => (
                <li key={page.id}>
                  <button
                    onClick={() => onNavigate('CUSTOM_PAGE', page.slug)}
                    className="text-white/60 hover:text-neon-cyan transition-colors"
                  >
                    {page.title}
                  </button>
                </li>
              ))}
            </ul>
          </div>

          {/* Contact */}
          <div>
            <h4 className="font-bold mb-4">{t('Contact', language)}</h4>
            <ul className="space-y-2 text-sm text-white/60">
              {config.contactEmail && (
                <li className="flex items-center gap-2">
                  <Mail size={16} className="text-neon-purple" />
                  {config.contactEmail}
                </li>
              )}
            </ul>
          </div>
        </div>

        <div className="border-t border-white/10 pt-8 text-center text-sm text-white/40">
          <p>¬© {new Date().getFullYear()} {config.storeName}. {t('All rights reserved', language)}.</p>
        </div>
      </div>
    </footer>
  );
};

export default App;
